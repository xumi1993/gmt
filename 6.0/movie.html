


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>movie &mdash; GMT 6.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nearneighbor" href="nearneighbor.html" />
    <link rel="prev" title="mask" href="mask.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> GMT
          

          
          </a>

          
            
            
              <div class="version">
                6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">GMT Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">GMT Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">GMT Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="users_contrib_scripts.html">Users Script Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="users_contrib_symbols.html">Users Symbol Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="deprecated_defaults.html">Deprecated GMT Defaults Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="switching.html">Switching between different GMT versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrating.html">Migrating from an earlier GMT version</a></li>
</ul>
<p class="caption"><span class="caption-text">Classic Mode</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="std_opts_classic.html">Common Options (Classic Mode)</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules_classic.html">GMT Modules (Classic Mode)</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GenericMappingTools/gmt/blob/master/CONTRIBUTING.md">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GenericMappingTools/gmt/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst_cheatsheet.html">reStructuredText Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging GMT</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">GMT C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="postscriptlight.html">PostScriptLight C API</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/gmt/blob/master/LICENSE.TXT"><i class="fa fa-book fa-fw"></i> License</a></li>
            
                <li class="toctree-l1"><a href="https://forum.generic-mapping-tools.org/"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/gmt"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">GMT Modules</a> &raquo;</li>
        
      <li>movie</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/GenericMappingTools/gmt/edit/6.0/doc/rst/source/movie.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="movie">
<span id="index-0"></span><h1>movie<a class="headerlink" href="#movie" title="Permalink to this headline">¶</a></h1>
<p>Create animation sequences and movies</p>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p><strong>gmt movie</strong> <em>mainscript</em>
<a class="reference internal" href="#c"><span> <strong>-C</strong></span></a></strong><em>canvas</em>
<a class="reference internal" href="#n"><span> <strong>-N</strong></span></a></strong><em>prefix</em>
<a class="reference internal" href="#t"><span> <strong>-T</strong></span></a></strong><em>nframes</em>|<em>timefile</em>[<strong>+p</strong><em>width</em>][<strong>+s</strong><em>first</em>][<strong>+w</strong>]
[ <a class="reference internal" href="#a"><span> <strong>-A</strong></span></a></strong>[<strong>+l</strong>[<em>n</em>]][<strong>+s</strong><em>stride</em>] ]
[ <a class="reference internal" href="#d"><span> <strong>-D</strong></span></a></strong><em>displayrate</em> ]
[ <a class="reference internal" href="#f"><span> <strong>-F</strong></span></a></strong><em>format</em>[<strong>+o</strong><em>options</em>]]
[ <a class="reference internal" href="#g"><span> <strong>-G</strong></span></a></strong><em>fill</em>]
[ <a class="reference internal" href="#h"><span> <strong>-H</strong></span></a></strong><em>factor</em>]
[ <a class="reference internal" href="#i"><span> <strong>-I</strong></span></a></strong><em>includefile</em> ]
[ <a class="reference internal" href="#l"><span> <strong>-L</strong></span></a></strong><em>labelinfo</em> ]
[ <a class="reference internal" href="#m"><span> <strong>-M</strong></span></a></strong>[<em>frame</em>],[<em>format</em>] ]
[ <a class="reference internal" href="#q"><span> <strong>-Q</strong></span></a></strong>[<strong>s</strong>] ]
[ <strong>-Sb</strong><em>backgroundscript</em> ]
[ <strong>-Sf</strong><em>foregroundscript</em> ]
[ <a class="reference internal" href="#v"><span> <strong>-V</strong></span></a></strong>[<em>level</em>] ]
[ <a class="reference internal" href="#z"><span> <strong>-Z</strong></span></a></strong> ]
[ <a class="reference internal" href="#w"><span> <strong>-W</strong></span></a></strong><em>workdir</em> ]
[ <strong>-x</strong>[[-]<em>n</em>] ]
[ <strong>--PAR</strong>=<em>value</em> ]</p>
<p><strong>Note:</strong> No space is allowed between the option flag and the associated arguments.</p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The <strong>movie</strong> module can generate GMT animation sequences using a single-plot script
that is repeated for all frames, with some variation using specific frame variables.  The
module simplifies (and hides) most of the steps normally needed to set up a full-blown
animation job.  Instead, the user can focus on composing the main frame plot and let the
parallel execution of frames and assembly of images into a movie take place in the background.
Individual frames are converted from PostScript plots to lossless, transparent PNG images and optionally
assembled into an animation (this last step requires external tools that must be present in
your path; see Technical Details below).  For opaque PNG images, simply specify a background
color via <strong>-G</strong>.</p>
</div>
<div class="section" id="required-arguments">
<h2>Required Arguments<a class="headerlink" href="#required-arguments" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><em>mainscript</em></dt>
<dd>Name of a stand-alone GMT modern mode script that makes the frame-dependent plot.  The
script may access frame variables, such as frame number and others, and may be
written using the Bourne shell (.sh), the Bourne again shell (.bash), the csh (.csh)
or DOS batch language (.bat).  The script language is inferred from the file extension
and we build hidden movie scripts using the same language.  Parameters that can be accessed
are discussed below.</dd>
</dl>
<dl class="docutils" id="c">
<dt><strong>-C</strong><em>canvassize</em></dt>
<dd>Specify the canvas size used when composing the movie frames. You can choose from a
set of preset formats or specify a custom layout.  The named 16:9 ratio
formats have a canvas dimension of 24 x 13.5 cm <em>or</em> 9.6 x 5.4 inch and are
(with pixel dimensions given in parenthesis):
<strong>4320p</strong> (7680 x 4320), <strong>2160p</strong> (3840 x 2160), <strong>1080p</strong> (1920 x 1080), <strong>720p</strong> (1280 x 720),
<strong>540p</strong> (960 x 540), <strong>480p</strong> (854 x 480), <strong>360p</strong> (640 x 360), and <strong>240p</strong> (426 x 240).
We also accept <strong>8k</strong> or <strong>uhd-2</strong> to mean <strong>4320p</strong>, <strong>4k</strong> or <strong>uhd</strong> to mean <strong>2160p</strong>, and <strong>hd</strong> to mean <strong>1080p</strong>.
The recognized 4:3 ratio formats have a canvas dimension of 24 x 18 cm <em>or</em> 9.6 x 7.2 inch
and are (with pixel dimensions given in parenthesis):
<strong>uxga</strong> (1600 x 1200), <strong>sxga+</strong> (1400 x 1050), <strong>xga</strong> (1024 x 768),
<strong>svga</strong> (800 x 600), and <strong>dvd</strong> (640 x 480).
Note: Your <a class="reference internal" href="gmt.conf.html#proj-length-unit"><span class="std std-ref">PROJ_LENGTH_UNIT</span></a> setting determines if <strong>movie</strong> sets
you up to work with the SI or US canvas dimensions.  Instead of a named format you can
request a custom format directly by giving <em>width</em>[<em>unit</em>]x<em>height</em>[<em>unit</em>]x<em>dpu</em>,
where <em>dpu</em> is the dots-per-unit pixel density (pixel density is set automatically for the named formats).</dd>
</dl>
<dl class="docutils" id="n">
<dt><strong>-N</strong><em>prefix</em></dt>
<dd>Determines the name of the final movie file and a sub-directory with frame images (but see <strong>-W</strong>).
Note: If the subdirectory exist then we exit immediately.  You are therefore required to remove any
old directory by that name first.  This is done to prevent the accidental loss of valuable data.</dd>
</dl>
<dl class="docutils" id="t">
<dt><strong>-T</strong><em>nframes</em>|<em>timefile</em>[<strong>+p</strong><em>width</em>][<strong>+s</strong><em>first</em>][<strong>+w</strong>]</dt>
<dd>Either specify how many image frames to make or supply a file with a set of parameters,
one record (i.e., row) per frame.  The values in the columns will be available to the
<em>mainscript</em> as named variables <strong>MOVIE_COL0</strong>, <strong>MOVIE_COL1</strong>, etc., while any trailing text
can be accessed via the variable <strong>MOVIE_TEXT</strong>.  Append <strong>+w</strong> to split the trailing
string into individual words that can be accessed via variables <strong>MOVIE_WORD0</strong>, <strong>MOVIE_WORD1</strong>,
etc. The number of records equals
the number of frames. Note that the <em>background</em> script is allowed to create <em>timefile</em>,
hence we check for its existence both before <em>and</em> after the background script has completed.  Normally,
the frame numbering starts at 0; you can change this by appending a different starting frame
number via <strong>+s</strong><em>first</em>.  Note: All frames are still included; this modifier only affects
the numbering of the given frames.  Finally, <strong>+p</strong> can be used to set the tag <em>width</em> of the format
used in naming frames.  For instance, name_000010.png has a tag width of 6.  By default, this
is automatically set but if you are splitting large jobs across several computers then you
must use the same tag width for all names.</dd>
</dl>
</div>
<div class="section" id="optional-arguments">
<h2>Optional Arguments<a class="headerlink" href="#optional-arguments" title="Permalink to this headline">¶</a></h2>
<dl class="docutils" id="a">
<dt><strong>-A</strong>[<strong>+l</strong>[<em>n</em>]][<strong>+s</strong><em>stride</em>]</dt>
<dd>Build an animated GIF file.  You may specify if the movie should play more than once (i.e., loop)
via <strong>+l</strong> and if so append how many times to repeat [infinite].  If a video product is also
selected (<strong>-F</strong>) then you can limit the frames being used to make the GIF file.  Append <strong>+s</strong><em>stride</em>
to only use every <em>stride</em> frame, with <em>stride</em> being one of a fixed set of strides: 2, 5, 10,
20, 50, 100, 200, and 500.</dd>
</dl>
<dl class="docutils" id="d">
<dt><strong>-D</strong><em>displayrate</em></dt>
<dd>Set the display frame rate in frames per seconds for the final animation [24].</dd>
</dl>
<dl class="docutils" id="f">
<dt><strong>-F</strong><em>format</em>[<strong>+o</strong><em>options</em>]</dt>
<dd>Set the format of the final video product.  Repeatable.  Choose either <strong>mp4</strong> (MPEG-4 movie) or
<strong>webm</strong> (WebM movie).  You may optionally add additional ffmpeg encoding settings for this format
via the <strong>+o</strong> modifier (in quotes if more than one word). If <strong>none</strong> is chosen then no PNGs will
be created at all; this requires <strong>-M</strong>.</dd>
</dl>
<dl class="docutils" id="g">
<dt><strong>-G</strong><em>fill</em> <a class="reference internal" href="cookbook/features.html#gfill-attrib"><span class="std std-ref">(more …)</span></a></dt>
<dd>Set the canvas color or fill before plotting commences [none].</dd>
</dl>
<dl class="docutils" id="h">
<dt><strong>-H</strong><em>factor</em></dt>
<dd>Given the finite dots-per-unit used to rasterize PostScript frames to PNGs, the quantizing of features
to discrete pixel will lead to rounding.  Some of this is mitigated by the anti-aliasing settings.  However,
changes from frame to frame is outside the control of the individual frame rasterization and we
find that, in particular, moving text may appear jittery when seen in the final animation.  You can mitigate
this effect by selecting a scale <em>factor</em> that, in effect, temporarily increases the effective dots-per-unit
by <em>factor</em>, rasterizes the frame, then downsamples the image by the same factor at the end.  The larger
the <em>factor</em>, the smoother the transitions.  Because processing time increases with <em>factor</em> we suggest you
try values in the 2-5 range.  Note that images can also suffer from quantizing when the original data have
much higher resolution than your final frame pixel dimensions.  The <strong>-H</strong> option may then be used to smooth the
result to avoid aliasing [no downsampling].  This effect is called <cite>sub-pixel rendering &lt;https://en.wikipedia.org/wiki/Subpixel_rendering&gt;</cite>.</dd>
</dl>
<dl class="docutils" id="i">
<dt><strong>-I</strong><em>includefile</em></dt>
<dd>Insert the contents of <em>includefile</em> into the movie_init.sh script that is accessed by all movie scripts.
This mechanism is used to add information (typically constant variable assignments) that the <em>mainscript</em>
and any optional <strong>-S</strong> scripts rely on.</dd>
</dl>
<dl class="docutils" id="l">
<dt><strong>-L</strong><em>labelinfo</em></dt>
<dd>Automatic labeling of individual frames.  Repeatable up to 32 labels.  Places the chosen label at the frame perimeter:
<strong>e</strong> selects the elapsed time in seconds as the label; append <strong>+s</strong><em>scale</em> to set the length
in seconds of each frame [Default is 1/<em>framerate</em>],
<strong>f</strong> selects the running frame number as the label, <strong>c</strong><em>col</em> uses the value in column
number <em>col</em> of <em>timefile</em> as label (first column is 0), while <strong>t</strong><em>col</em> uses word number
<em>col</em> from the trailing text in <em>timefile</em> (requires <strong>-T</strong>…<strong>+w</strong>; first word is 0).  Note: If you use <strong>-Lc</strong>
with an absolute time column, then the format of the timestamp will depend on the two default settings
<a class="reference internal" href="gmt.conf.html#format-date-map"><span class="std std-ref">FORMAT_DATE_MAP</span></a> and <a class="reference internal" href="gmt.conf.html#format-clock-map"><span class="std std-ref">FORMAT_CLOCK_MAP</span></a>.  By default,
both <em>date</em> and <em>time</em> are displayed (with a space between); set one of the settings to “-” to skip that component.
Append <strong>+c</strong><em>dx</em>[/<em>dy</em>] for the clearance between label and bounding box; only
used if <strong>+g</strong> or <strong>+p</strong> are set.  Append units <strong>c</strong>|<strong>i</strong>|<strong>p</strong> or % of the font size [15%].
Append <strong>+f</strong> to use a specific <em>font</em> [<a class="reference internal" href="gmt.conf.html#font-tag"><span class="std std-ref">FONT_TAG</span></a>].
Append <strong>+g</strong> to fill the label bounding box with <em>fill</em> color [no fill].
Use <strong>+j</strong><em>refpoint</em> to specify where the label should be plotted [TL].
Append <strong>+o</strong><em>dx</em>[/<em>dy</em>] to offset label in direction implied by <em>justify</em>. Append units
<strong>c</strong>|<strong>i</strong>|<strong>p</strong> or % of the font size [20% of font size].
Append <strong>+p</strong> to draw the outline of the bounding box using selected <em>pen</em> [no outline].
Append <strong>+t</strong> to provide a <em>format</em> statement to be used with the label item selected [no special formatting].
If <strong>-Lt</strong> is used then the format statement must contain a %s-like format, else it may have an integer (%d)
or floating point  (%e, %f, %g) format specification.</dd>
</dl>
<dl class="docutils" id="m">
<dt><strong>-M</strong>[<em>frame</em>],[<em>format</em>]</dt>
<dd>In addition to making the animation sequence, select a single master frame [0] for a cover page.  The master frame will
be written to the current directory with name <em>prefix.format</em>, where <em>format</em> can one of the
graphics extensions from the allowable graphics <a class="reference internal" href="begin.html#tbl-formats"><span class="std std-ref">formats</span></a> [pdf].</dd>
</dl>
<dl class="docutils" id="q">
<dt><strong>-Q</strong>[<strong>s</strong>]</dt>
<dd>Debugging: Leave all files and directories we create behind for inspection.  Alternatively, append <strong>s</strong> to
only build the movie scripts but not perform any execution.  One exception involves the optional
background script derived from <strong>-Sb</strong> which is always executed since it may produce data needed when
building the movie scripts.</dd>
</dl>
<dl class="docutils" id="sb">
<dt><strong>-Sb</strong><em>backgroundscript</em></dt>
<dd>The optional GMT modern mode <em>backgroundscript</em> (written in the same scripting language as <em>mainscript</em>) can be
used for one or two purposes: (1) It may create files (such as <em>timefile</em>) that will be needed by <em>mainscript</em>
to make the movie, and (2) It may make a static background plot that should form the background for all frames.
If a plot is generated the script must make sure it uses the same positioning (i.e., <strong>-X -Y</strong>) as the main script
so that the layered plot will stack correctly (unless you actually want a different offset).</dd>
</dl>
<dl class="docutils" id="sf">
<dt><strong>-Sf</strong><em>foregroundscript</em></dt>
<dd>The optional GMT modern mode <em>foregroundscript</em> (written in the same scripting language as <em>mainscript</em>) can be
used to make a static foreground plot that should be overlain on all frames.  Make sure the script uses the same
positioning (i.e., <strong>-X -Y</strong>) as the main script so that the layers will stack correctly.</dd>
</dl>
<dl class="docutils" id="movie-v">
<dt><strong>-V</strong>[<em>level</em>] <a class="reference internal" href="gmt.html#v-full"><span class="std std-ref">(more …)</span></a></dt>
<dd>Select verbosity level [c].  </dd>
</dl>
<dl class="docutils" id="w">
<dt><strong>-W</strong><em>workdir</em></dt>
<dd>By default, all temporary files and frame PNG file are built in the subdirectory <em>prefix</em> set via <strong>-N</strong>.
You can override that selection by giving another <em>workdir</em> as a relative or full directory path.</dd>
</dl>
<dl class="docutils" id="z">
<dt><strong>-Z</strong></dt>
<dd>Erase the entire <em>prefix</em> directory after assembling the final movie [Default leaves directory with all images;
the script files, parameter files, and layer PostScript files are all removed (but see <strong>-Q</strong>)].</dd>
</dl>
<dl class="docutils" id="cores">
<dt><strong>-x</strong>[[-]<em>n</em>]</dt>
<dd>Limit the number of cores used when making the individual frames.
By default we try to use all available cores.  Append <em>n</em> to only use <em>n</em> cores
(if too large it will be truncated to the maximum cores available).  Finally,
give a negative <em>n</em> to select (all - <em>n</em>) cores (or at least 1 if <em>n</em> equals or exceeds all).
The parallel processing does not depend on OpenMP.</dd>
</dl>
<dl class="docutils">
<dt><strong>-^</strong> or just <strong>-</strong></dt>
<dd>Print a short message about the syntax of the command, then exits (NOTE: on Windows just use <strong>-</strong>).</dd>
<dt><strong>-+</strong> or just <strong>+</strong></dt>
<dd>Print an extensive usage (help) message, including the explanation of
any module-specific option (but not the GMT common options), then exits.</dd>
<dt><strong>-?</strong> or no arguments</dt>
<dd>Print a complete usage (help) message, including the explanation of all options, then exits.</dd>
<dt><strong>--PAR</strong>=<em>value</em></dt>
<dd>Temporarily override a GMT default setting; repeatable. See <a class="reference internal" href="gmt.conf.html"><span class="doc">gmt.conf</span></a> for parameters.</dd>
</dl>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>Several parameters are automatically assigned and can be used when composing <em>mainscript</em> and the optional
<em>backgroundscript</em> and <em>foregroundscript</em> scripts. There are two sets of parameters: Those that are constants
and those that change with the frame number.  The constants are accessible by all the scripts:
<strong>MOVIE_WIDTH</strong>: The width of the canvas,
<strong>MOVIE_HEIGHT</strong>: The height of the canvas,
<strong>MOVIE_DPU</strong>: The current dots-per-unit,
<strong>MOVIE_RATE</strong>: The current number of frames per second,
<strong>MOVIE_NFRAMES</strong>: The total number of frames.
Also, if <strong>-I</strong> was used then any static parameters listed there will be available to all the scripts as well.
In addition, the <em>mainscript</em> also has access to parameters that vary with the frame counter:
<strong>MOVIE_FRAME</strong>: The current frame number (an integer, e.g., 136),
<strong>MOVIE_TAG</strong>: The formatted frame number (a string, e.g., 000136), and
<strong>MOVIE_NAME</strong>: The name prefix for the current frame (i.e., <em>prefix</em>_<strong>MOVIE_TAG</strong>),
Furthermore, if a <em>timefile</em> was given then variables <strong>MOVIE_COL0</strong>, <strong>MOVIE_COL1</strong>, etc. are
also set, yielding one variable per column in <em>timefile</em>.  If <em>timefile</em> has trailing text then that text can
be accessed via the variable <strong>MOVIE_TEXT</strong>, and if word-splitting was requested by <strong>-T+w</strong> then
the trailing text is also split into individual word parameters <strong>MOVIE_WORD0</strong>, <strong>MOVIE_WORD1</strong>, etc.</p>
</div>
<div class="section" id="data-files">
<h2>Data Files<a class="headerlink" href="#data-files" title="Permalink to this headline">¶</a></h2>
<p>The movie scripts will be able to find any files present in the starting directory when <strong>movie</strong> was initiated,
as well as any new files produced by <em>mainscript</em> or the optional scripts set via <strong>-S</strong>.
No path specification is needed to access these files.  Other files may
require full paths unless their directories were already included in the <a class="reference internal" href="gmt.conf.html#dir-data"><span class="std std-ref">DIR_DATA</span></a> setting.</p>
</div>
<div class="section" id="your-canvas">
<h2>Your Canvas<a class="headerlink" href="#your-canvas" title="Permalink to this headline">¶</a></h2>
<p>As you can see from <strong>-C</strong>, unless you specified a custom format you are given a canvas size that is either 24 x 13.5 cm (16:9)
or 24 x 18 cm (4:3).  If your <a class="reference internal" href="gmt.conf.html#proj-length-unit"><span class="std std-ref">PROJ_LENGTH_UNIT</span></a> setting is inch then the custom canvas sizes are just
slightly (1.6%) larger than the corresponding SI sizes (9.6 x 5.4” or 9.6 x 7.2”); this has no effect on the size of the movie
frames but allow us to use good sizes that work well with the dpu chosen.  You should compose your plots using
the given canvas size, and <strong>movie</strong> will make proper conversions of the canvas to image pixel dimensions. It is your responsibility
to use <strong>-X -Y</strong> to allow for suitable margins and any positioning of items on the canvas.  To minimize processing time it is
recommended that any static part of the movie be considered either a static background (to be made once by <em>backgroundscript</em>) and/or
a static foreground (to be made once by <em>foregroundscript</em>); <strong>movie</strong> will then assemble these layers per frame.  Also, any computation of
static data files to be used in the loop over frames can be produced by <em>backgroundscript</em>.  Any data or variables that depend on the
frame number must be computed or set by <em>mainscript</em> or provided via the parameters as discussed above.</p>
</div>
<div class="section" id="technical-details">
<h2>Technical Details<a class="headerlink" href="#technical-details" title="Permalink to this headline">¶</a></h2>
<p>The <strong>movie</strong> module creates several hidden script files that are used in
the generation of the images (here we have left the file extension off since it depends on the
scripting language used): <em>movie_init</em> (initializes variables related to canvas size and dots-per-unit,
and includes the contents of the optional <em>includefile</em>), <em>movie_preflight</em> (optional since it derives
from <strong>-Sb</strong> and computes needed data files and possibly a background layer), <em>movie_postflight</em>
(optional since it derives from <strong>-Sf</strong> and builds a foreground layer), <em>movie_frame</em> (accepts a frame counter
argument and builds the frame image), and <em>movie_cleanup</em> (removes temporary files at the end of the
run). For each frame there is a separate <em>movie_params_######</em> script that provides frame-specific
variables (e.g., frame number and anything given via <strong>-T</strong>).  The pre- and post-flight scripts have
access to the information in <em>movie_init</em> while the frame script in addition has access to the frame-
specific parameter file.  Using the <strong>-Q</strong> option will just produce these scripts which you can then examine.</p>
<p>The conversion of PNG frames to an animated GIF (<strong>-F</strong>gif) relies on <a class="reference external" href="http://www.graphicsmagick.org/">GraphicsMagick</a>.
Thus, <strong>gm</strong> must be accessible via your standard search path. Likewise, the conversion of
PNG frames to an MP4 (<strong>-F</strong>mp4) or WebM (<strong>-F</strong>webm) movie relies on <a class="reference external" href="https://www.ffmpeg.org/">FFmpeg</a>.</p>
</div>
<div class="section" id="hints-for-movie-makers">
<h2>Hints for Movie Makers<a class="headerlink" href="#hints-for-movie-makers" title="Permalink to this headline">¶</a></h2>
<p>Composing movies is relatively simple but you have to think in terms of variables.
Examine the examples we have described.  Then, start by making a single plot script (your <em>mainscript</em>) and identify which
things should change with time (i.e., with the frame number).  Create variables for these values. If they
are among the listed parameters that <strong>movie</strong> creates then use those names.  Unless you only
require the frame number you will need to make a file that you can pass to <strong>-T</strong>.  This file should
then have all the values you need, per frame (i.e., row), with values across all the columns you need.
If you need to assign various fixed variables that do not change with time then your <em>mainscript</em>
will look shorter and cleaner if you offload those assignments to a separate <em>includefile</em> (<strong>-I</strong>).
To test your movie, start by using options <strong>-F</strong>none <strong>-Q -M</strong> to ensure your master frame page looks correct.
This page shows you one frame of your movie (you can select which frame via the <strong>-M</strong> arguments).  Fix any
issues with your use of variables and options until this works.  You can then try to remove <strong>-Q</strong>.
We recommend you make a very short (i.e., <strong>-T</strong>) and small (i.e., <strong>-C</strong>) movie so you don’t have to wait very
long to see the result.  Once things are working you can beef up number of frames and movie quality.</p>
</div>
<div class="section" id="color-table-usage">
<h2>Color Table Usage<a class="headerlink" href="#color-table-usage" title="Permalink to this headline">¶</a></h2>
<p>Because <strong>movie</strong> launches individual frame plots as separate sessions running in parallel, we cannot
utilize the current CPT (i.e., the last CPT created directly by <a class="reference internal" href="makecpt.html"><span class="doc">makecpt</span></a> or <a class="reference internal" href="grd2cpt.html"><span class="doc">grd2cpt</span></a>, or
indirectly by <a class="reference internal" href="grdimage.html"><span class="doc">grdimage</span></a> or  <a class="reference internal" href="grdview.html"><span class="doc">grdview</span></a>).  Instead, you must create CPTs using explicit
files and pass those names to the modules that require CPT information.  In modern mode, this means
you need to use the <strong>-H</strong> option in <a class="reference internal" href="makecpt.html"><span class="doc">makecpt</span></a> or <a class="reference internal" href="grd2cpt.html"><span class="doc">grd2cpt</span></a> in order to redirect their output
to named files.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>To make an animated GIF movie based on the script globe.sh, which simply spins a globe using the
frame number to serve as the view longitude, using a custom square 600x600 pixel canvas and 360 frames,
and place a frame counter in the top left corner, try:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt movie globe.sh -Nglobe -T360 -Agif -C6ix6ix100 -Lf
</pre></div>
</div>
<p>Here, the globe.sh bash script simply plots a map with <a class="reference internal" href="coast.html"><span class="doc">coast</span></a> but uses the frame number variable
as the center longitude:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt begin
   gmt coast -Rg -JG<span class="si">${</span><span class="nv">MOVIE_FRAME</span><span class="si">}</span>/20/<span class="si">${</span><span class="nv">MOVIE_WIDTH</span><span class="si">}</span> -Gmaroon -Sturquoise -Bg -X0 -Y0
gmt end
</pre></div>
</div>
<p>As the automatic frame loop is executed the different frames will be produced with different
longitudes.  The equivalent DOS batch script setup would be:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt movie globe.bat -Nglobe -T360 -Agif -C6ix6ix100 -Lf
</pre></div>
</div>
<p>Now, the globe.bat DOS script is simply:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt begin
   gmt coast -Rg -JG%MOVIE_FRAME%/20/%MOVIE_WIDTH% -Gmaroon -Sturquoise -Bg -X0 -Y0
gmt end
</pre></div>
</div>
<p>i.e., the syntax of how variables are used vary according to the scripting language. At the
end of the execution we find the animated GIF globe.gif and a directory (called globe) that contains all 360 PNG images.
Note that there is no information in the globe scripts that reflects the name of the plot, the canvas size,
the dimensions of the rasterized PostScript, and so on.  That information is hidden from the user;
the actual movie scripts that execute are derived from the user-provided scripts and supply
the extra machinery. The <strong>movie</strong> module automatically manages the parallel execution loop over all frames using
all available cores.</p>
</div>
<div class="section" id="longer-examples">
<h2>Longer Examples<a class="headerlink" href="#longer-examples" title="Permalink to this headline">¶</a></h2>
<p>To explore more elaborate movies, see the Animations examples under our <a class="reference internal" href="gallery.html"><span class="doc">Gallery</span></a>.</p>
</div>
<div class="section" id="other-movie-formats">
<h2>Other Movie Formats<a class="headerlink" href="#other-movie-formats" title="Permalink to this headline">¶</a></h2>
<p>As configured, <strong>movie</strong> only offers the MP4 and WebM formats for movies.  The conversion is performed by the
tool <a class="reference external" href="https://www.ffmpeg.org/">FFmpeg</a>, which has more codecs and processing options than there are children in China.
If you wish to run ffmpeg with other options, select mp4 and run <strong>movie</strong> with long verbose (<strong>-Vl</strong>).
At the end it will print the ffmpeg command used.  You can copy, paste, and modify this command to
select other codecs, bit-rates, and arguments.  You can also use the PNG sequence as input to tools such
as QuickTime Pro, iMovie, MovieMaker, and similar commercial programs to make a movie that way.</p>
</div>
<div class="section" id="manipulating-multiple-movies">
<h2>Manipulating Multiple Movies<a class="headerlink" href="#manipulating-multiple-movies" title="Permalink to this headline">¶</a></h2>
<p>If you are making a series of similar movies, you can use ffmpeg to paste and stitch them into a single movie.
Assume we have four movies called movie_1.mp4, movie_2.mp4, movie_3.mp4, and movie_4.mp4, and you wish to combine
them into a 2x2 panel showing the four movies simultaneously.  You would first combine movies (1,2) and (3,4)
horizontally, then combine the two resulting strips vertically:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ffmpeg -i movie_1.mp4 -i movie_2.mp4 -filter_complex <span class="nv">hstack</span><span class="o">=</span><span class="nv">inputs</span><span class="o">=</span><span class="m">2</span> top.mp4
ffmpeg -i movie_3.mp4 -i movie_4.mp4 -filter_complex <span class="nv">hstack</span><span class="o">=</span><span class="nv">inputs</span><span class="o">=</span><span class="m">2</span> bottom.mp4
ffmpeg -i top.mp4 -i bottom.mp4 -filter_complex <span class="nv">vstack</span><span class="o">=</span><span class="nv">inputs</span><span class="o">=</span><span class="m">2</span> four_movies.mp4
</pre></div>
</div>
<p>For more information on such manipulations, see the FFmpeg documentation.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="gmt.html"><span class="doc">gmt</span></a>,
<a class="reference internal" href="events.html"><span class="doc">events</span></a>,
<a class="reference internal" href="psconvert.html"><span class="doc">psconvert</span></a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nearneighbor.html" class="btn btn-neutral float-right" title="nearneighbor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mask.html" class="btn btn-neutral float-left" title="mask" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The GMT Team.
      <span class="lastupdated">
        Last updated on Jan 16, 2020.
      </span>

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>
